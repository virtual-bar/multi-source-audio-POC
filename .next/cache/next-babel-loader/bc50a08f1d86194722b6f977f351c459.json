{"ast":null,"code":"var _this = this,\n    _jsxFileName = \"C:\\\\Users\\\\Brandon Whittle\\\\Desktop\\\\Virtual Bar\\\\multi-source-audio-POC\\\\components\\\\AudioTrack.tsx\";\n\nvar __jsx = React.createElement;\nimport React, { useState, useEffect } from 'react';\nimport { Button } from './styles';\n\nvar useAudio = function useAudio(_ref) {\n  var initialGain = _ref.initialGain;\n  var AudioContext = window.AudioContext || window.webkitAudioContext;\n\n  var _useState = useState(new AudioContext()),\n      audioCtx = _useState[0];\n\n  var _useState2 = useState(audioCtx.createGain()),\n      gainNode = _useState2[0];\n\n  gainNode.gain.value = initialGain;\n  return {\n    audioCtx: audioCtx,\n    gainNode: gainNode\n  };\n};\n\nvar AudioTrack = function AudioTrack(_ref2) {\n  var audioElement = _ref2.audioElement;\n\n  var _useState3 = useState(false),\n      playing = _useState3[0],\n      setPlaying = _useState3[1];\n\n  var _useState4 = useState(false),\n      volume = _useState4[0],\n      setVolume = _useState4[1];\n\n  var _useAudio = useAudio({\n    initialGain: 1\n  }),\n      audioCtx = _useAudio.audioCtx,\n      gainNode = _useAudio.gainNode;\n\n  var togglePlaying = function togglePlaying() {\n    if (audioCtx.state === 'suspended') {\n      audioCtx.resume();\n    }\n\n    setPlaying(!playing);\n  };\n\n  var changeVolume = function changeVolume(e) {\n    var value = e.target.value;\n    setVolume(value);\n  };\n\n  var getAudioElement = function getAudioElement() {\n    return audioElement;\n  };\n\n  useEffect(function () {\n    var audioElement = getAudioElement();\n    var track = audioCtx.createMediaElementSource(audioElement);\n    track.connect(gainNode).connect(audioCtx.destination);\n  }, []);\n  useEffect(function () {\n    var audioElement = getAudioElement();\n\n    if (playing && audioElement.paused) {\n      audioElement.play();\n    } else if (!playing && !audioElement.paused) {\n      audioElement.pause();\n    }\n\n    gainNode.gain.value = volume;\n  }, [playing, volume]);\n  return __jsx(React.Fragment, null, __jsx(Button, {\n    \"data-playing\": playing,\n    className: \"control-play\",\n    role: \"switch\",\n    onClick: togglePlaying,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }\n  }, playing ? 'Playing' : 'Paused'), __jsx(\"input\", {\n    type: \"range\",\n    id: \"volume\",\n    className: \"control-volume\",\n    min: \"0\",\n    max: \"2\",\n    value: volume,\n    onChange: changeVolume,\n    list: \"gainVals\",\n    step: \"0.01\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 7\n    }\n  }), __jsx(\"datalist\", {\n    id: \"gainVals\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }\n  }, __jsx(\"option\", {\n    value: \"1\",\n    label: \"unity\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }\n  })));\n};\n\nexport default AudioTrack;","map":{"version":3,"sources":["C:/Users/Brandon Whittle/Desktop/Virtual Bar/multi-source-audio-POC/components/AudioTrack.tsx"],"names":["React","useState","useEffect","Button","useAudio","initialGain","AudioContext","window","webkitAudioContext","audioCtx","createGain","gainNode","gain","value","AudioTrack","audioElement","playing","setPlaying","volume","setVolume","togglePlaying","state","resume","changeVolume","e","target","getAudioElement","track","createMediaElementSource","connect","destination","paused","play","pause"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Button } from './styles';\r\n\r\nconst useAudio = ({ initialGain }) => {\r\n  const AudioContext = window.AudioContext || window.webkitAudioContext;\r\n  const [audioCtx] = useState(new AudioContext());\r\n  const [gainNode] = useState(audioCtx.createGain());\r\n\r\n  gainNode.gain.value = initialGain;\r\n\r\n  return { audioCtx, gainNode };\r\n};\r\n\r\nconst AudioTrack = ({ audioElement }) => {\r\n  const [playing, setPlaying] = useState(false);\r\n  const [volume, setVolume] = useState(false);\r\n\r\n  const { audioCtx, gainNode } = useAudio({ initialGain: 1 });\r\n\r\n  const togglePlaying = () => {\r\n    if (audioCtx.state === 'suspended') {\r\n      audioCtx.resume();\r\n    }\r\n    setPlaying(!playing);\r\n  };\r\n\r\n  const changeVolume = e => {\r\n    const {\r\n      target: { value }\r\n    } = e;\r\n    setVolume(value);\r\n  };\r\n\r\n  const getAudioElement = () => audioElement;\r\n\r\n  useEffect(() => {\r\n    const audioElement = getAudioElement();\r\n    const track = audioCtx.createMediaElementSource(audioElement);\r\n\r\n    track.connect(gainNode).connect(audioCtx.destination);\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    const audioElement = getAudioElement();\r\n\r\n    if (playing && audioElement.paused) {\r\n      audioElement.play();\r\n    } else if (!playing && !audioElement.paused) {\r\n      audioElement.pause();\r\n    }\r\n\r\n    gainNode.gain.value = volume;\r\n  }, [playing, volume]);\r\n\r\n  return (\r\n    <>\r\n      <Button\r\n        data-playing={playing}\r\n        className=\"control-play\"\r\n        role=\"switch\"\r\n        onClick={togglePlaying}\r\n      >\r\n        {playing ? 'Playing' : 'Paused'}\r\n      </Button>\r\n\r\n      <input\r\n        type=\"range\"\r\n        id=\"volume\"\r\n        className=\"control-volume\"\r\n        min=\"0\"\r\n        max=\"2\"\r\n        value={volume}\r\n        onChange={changeVolume}\r\n        list=\"gainVals\"\r\n        step=\"0.01\"\r\n      />\r\n      <datalist id=\"gainVals\">\r\n        <option value=\"1\" label=\"unity\" />\r\n      </datalist>\r\n    </>\r\n  );\r\n};\r\nexport default AudioTrack;\r\n"]},"metadata":{},"sourceType":"module"}